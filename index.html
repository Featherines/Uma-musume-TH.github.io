<html class="  webp webp-alpha webp-animation webp-lossless" lang="en"><head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-133296718-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-133296718-1');
    </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <link rel="icon" href="../../images/webpage/icon.png">

    <!-- SCRIPTS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/treant-js/1.0/Treant.min.js"></script>
    <script src="../../vendor/modernizr/modernizr-custom.js"></script> <!-- WEBP CHECK -->
    <script src="../../scripts/priconne-data.js"></script>

    <!-- CSS STYLE SHEETS -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/treant-js/1.0/Treant.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="../../css/spritesheet.css">
    <link rel="stylesheet" href="../../css/data.css">
</head>
<body>
<noscript>
    <style type="text/css">
        div {display: none;}
        hr {display: none;}
        footer {display: none;}
    </style>
    <h1 style="color: white; font-family: 'Trebuchet MS', Arial, serif; text-align:center; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); text-shadow: 1px 1px 2px #000000;">
        <span style="color: orangered;">JavaScript is disabled!</span>
        <br><br>
        <span style="color: deepskyblue;">Uma-musume-TH/</span> cannot function without JavaScript.
        <br><br>
        <span style="color: #ffdf73;">Please enable JavaScript to continue!</span>
    </h1>
</noscript>
    <div id="back" onclick="toggle_catalog()" hidden="">↩</div>
<img id="character-box-button" src="../../images/webpage/Inventory_Crate.png" onclick="toggle_character_box()" alt="">



<div>
    <h1 class="title main_title">Uma Musume Pretty Derby - Skill search</h1>
    <h2 class="title sub_title">Beta test</h2>
    <h1 class="title simple_title">Uma Musume Pretty Derby - Skill search</h1>
</div>

<hr>
<div id="catalog"><div class="SSR"><i title="道悪◯" style="" class="item-sprite is__SSR1"></i><i title="道悪◯" style="" class="item-sprite is__SSR2"></i><i title="道悪◯" style="" class="item-sprite is__SSR3"></i><i title="道悪◯" style="" class="item-sprite is__SSR4"></i><i title="道悪◯" style="" class="item-sprite is__-5"></i><i title="道悪◯" style="" class="item-sprite is__-6"></i><i title="道悪◯" style="" class="item-sprite is__-7"></i><i title="道悪◯" style="" class="item-sprite is__-8"></i><i title="道悪◯" style="" class="item-sprite is__-9"></i><i title="道悪◯" style="" class="item-sprite is__-10"></i><i title="道悪◯" style="" class="item-sprite is__-11"></i><i title="道悪◯" style="" class="item-sprite is__-12"></i><i title="道悪◯" style="" class="item-sprite is__-13"></i><i title="道悪◯" style="" class="item-sprite is__-14"></i><i title="道悪◯" style="" class="item-sprite is__-15"></i><i title="道悪◯" style="" class="item-sprite is__-16"></i><i title="道悪◯" style="" class="item-sprite is__-19"></i><i title="道悪◯" style="" class="item-sprite is__-17"></i><i title="道悪◯" style="" class="item-sprite is__-18"></i><i title="道悪◯" style="" class="item-sprite is__-20"></i><i title="道悪◯" style="" class="item-sprite is__-21"></i><i title="道悪◯" style="" class="item-sprite is__-22"></i><i title="道悪◯" style="" class="item-sprite is__-23"></i></div><div class="SR"><i class="item-sprite is__gear-blade" title="Gear Blade"></i><i class="item-sprite is__blue-blood" title="Blue Blood"></i><i class="item-sprite is__aurora-sword" title="Aurora Sword"></i><i class="item-sprite is__crescent-sword" title="Crescent Sword"></i><i class="item-sprite is__command-knife" title="Command Knife"></i><i class="item-sprite is__leather-knuckle" title="Leather Knuckle"></i><i class="item-sprite is__crystal-bow" title="Crystal Bow"></i><i class="item-sprite is__trident" title="Trident"></i><i class="item-sprite is__flame-spear" title="Flame Spear"></i><i class="item-sprite is__metal-axe" title="Metal Axe"></i><i class="item-sprite is__high-metal-axe" title="High-Metal Axe"></i><i class="item-sprite is__green-rod" title="Green Rod"></i><i class="item-sprite is__little-dragon-rod" title="Little Dragon Rod"></i><i class="item-sprite is__doctorless-staff" title="Doctorless Staff"></i><i class="item-sprite is__compassion-of-the-unicorn" title="Compassion of the Unicorn"></i><i class="item-sprite is__clothes-of-wisdom" title="Clothes of Wisdom"></i><i class="item-sprite is__light-plate" title="Light Plate"></i><i class="item-sprite is__scale-mail" title="Scale Mail"></i><i class="item-sprite is__high-metal-plate" title="High Metal Plate"></i><i class="item-sprite is__folklore-clothes" title="Folklore Clothes"></i><i class="item-sprite is__shinobi-costume" title="Shinobi Costume"></i><i class="item-sprite is__spring-color-robe" title="Spring Color Robe"></i><i class="item-sprite is__nordic-robe" title="Nordic Robe"></i><i class="item-sprite is__tower-shield" title="Tower Shield"></i><i class="item-sprite is__crown-boots" title="Crown Boots"></i><i class="item-sprite is__hunting-boots" title="Hunting Boots"></i><i class="item-sprite is__witch-boots" title="Witch Boots"></i><i class="item-sprite is__cute-caskets" title="Cute Caskets"></i><i class="item-sprite is__legion-helm" title="Legion Helm"></i><i class="item-sprite is__nuns-hood" title="Nun's Hood"></i><i class="item-sprite is__jewel-of-courage" title="Jewel of Courage"></i><i class="item-sprite is__spike-bangle" title="Spike Bangle"></i><i class="item-sprite is__jewel-of-love" title="Jewel of Love"></i><i class="item-sprite is__victory-friendship-bracelet" title="Victory Friendship Bracelet"></i><i class="item-sprite is__magic-glasses" title="Magic Glasses"></i><i class="item-sprite is__jewel-of-wisdom" title="Jewel of Wisdom"></i><i class="item-sprite is__magic-monocle" title="Magic Monocle"></i><i class="item-sprite is__pattern-bracelet" title="Pattern Bracelet"></i></div><div class="R"><i class="item-sprite is__sparkling-sword" title="Sparkling Sword"></i><i class="item-sprite is__ryuumon-sword" title="Ryuumon Sword"></i><i class="item-sprite is__feather-blade" title="Feather Blade"></i><i class="item-sprite is__moonlight-sword" title="Moonlight Sword"></i><i class="item-sprite is__thunder-god-sword" title="Thunder God Sword"></i><i class="item-sprite is__platinum-knife" title="Platinum Knife"></i><i class="item-sprite is__vampire-dagger" title="Vampire Dagger"></i><i class="item-sprite is__dragons-claw" title="Dragon's Claw"></i><i class="item-sprite is__cupids-bow" title="Cupid's Bow"></i><i class="item-sprite is__devils-bow" title="Devil's Bow"></i><i class="item-sprite is__knights-pride" title="Knight's Pride"></i><i class="item-sprite is__absolute-spear" title="Absolute Spear"></i><i class="item-sprite is__blue-sphere-axe" title="Blue Sphere Axe"></i><i class="item-sprite is__lions-battle-axe" title="Lion's Battle Axe"></i><i class="item-sprite is__lightning-axe" title="Lightning Axe"></i><i class="item-sprite is__thorn-blood-rod" title="Thorn Blood Rod"></i><i class="item-sprite is__devils-horn" title="Devil's Horn"></i><i class="item-sprite is__celestial-sphere-watcher" title="Celestial Sphere Watcher"></i><i class="item-sprite is__flower-bud-wand" title="Flower Bud Wand"></i><i class="item-sprite is__fashion-armor" title="Fashion Armor"></i><i class="item-sprite is__battling-dress" title="Battling Dress"></i><i class="item-sprite is__heavy-metal-armor" title="Heavy Metal Armor"></i><i class="item-sprite is__gorgeous-armor" title="Gorgeous Armor"></i><i class="item-sprite is__millefeuille-cloth" title="Millefeuille Cloth"></i><i class="item-sprite is__palace-cloth" title="Palace Cloth"></i><i class="item-sprite is__cosmos-cloth" title="Cosmos Cloth"></i><i class="item-sprite is__cupid-robe" title="Cupid Robe"></i><i class="item-sprite is__philosophers-robe" title="Philosopher's Robe"></i><i class="item-sprite is__garnet-shield" title="Garnet Shield"></i><i class="item-sprite is__shinobi-shoes" title="Shinobi Shoes"></i><i class="item-sprite is__fencer-boots" title="Fencer Boots"></i><i class="item-sprite is__witch-palace-boots" title="Witch Palace Boots"></i><i class="item-sprite is__dragon-head" title="Dragon Head"></i><i class="item-sprite is__witch-headband" title="Witch Headband"></i><i class="item-sprite is__witch-hat" title="Witch Hat"></i><i class="item-sprite is__opal-earrings" title="Opal Earrings"></i><i class="item-sprite is__lion-eagles-feather" title="Lion Eagle's Feather"></i><i class="item-sprite is__scarlet-diamond" title="Scarlet Diamond"></i><i class="item-sprite is__emerald-earrings" title="Emerald Earrings"></i><i class="item-sprite is__octogram-pendant" title="Octogram Pendant"></i><i class="item-sprite is__lion-kings-protective-charm" title="Lion King's Protective Charm"></i><i class="item-sprite is__turquoise-earrings" title="Turquoise Earrings"></i><i class="item-sprite is__pearl-earrings" title="Pearl Earrings"></i><i class="item-sprite is__sorcerers-glasses" title="Sorcerer's Glasses"></i><i class="item-sprite is__laurels-sorrow" title="Laurel's Sorrow"></i></div>

<div id="recipe-data-div" class="notranslate" hidden=""></div>
<hr>




<script>
    let legacy_data, current_data, item_usage = {}, component_usage = {}, localstorage_data = null;
    const LOCALSTORAGE_KEY = "recipe-data_characters";
    function get_item_sprite_class(item_name) {
        return "is__" + item_name.replace("'", "").replace(/\W/g, '-').toLowerCase().replace('---', '-');
    }
    function get_item_image_path(file_name = "") {
        file_name = file_name.split(' ').join('_');
        return "../../images/items" + ($("html").hasClass("webp") ? "_webp/" + file_name + ".webp" : "/" + file_name + ".png");
    }
    function get_unit_sprite_class(unit_id) {
        return "us__" + unit_id.replace(/_/g, '-').toLowerCase().replace('---', '-');
    }
    function toggle_catalog() {
        const catalog = document.getElementById("catalog"),
              data = document.getElementById("recipe-data-div"),
              back = document.getElementById("back"),
              character_box = document.getElementById("character-box-button");
        catalog.hidden = character_box.hidden = !catalog.hidden;
        data.hidden = back.hidden = !data.hidden;
        if (data.hidden) {
            $(window).off();
        }
        window.scrollTo(0, 0);
    }
    function toggle_character_box() {
        const catalog = document.getElementById("catalog"),
              character_box = document.getElementById("character-box");
        catalog.hidden = !catalog.hidden;
        character_box.hidden = !character_box.hidden;

    }
    window.onload = function ()
    {
        equipment_data.read_data(function (success) {
            if (success) {
                current_data = equipment_data.data();
                equipment_data.set_loaded_version(equipment_data.version.LEGACY);
                equipment_data.read_data(function (success) {
                    if (success) {
                        legacy_data = equipment_data.data();
                        character_data.read_data(function (success) {
                            if (success)
                                build_catalog();
                            else
                                document.getElementById("catalog").innerHTML = "failed to read character data";
                        });
                    }
                    else
                        document.getElementById("catalog").innerHTML = "failed to read equipment data (legacy)";
                });
            }
            else
                document.getElementById("catalog").innerHTML = "failed to read equipment data (current)";
        });

        function build_catalog() {
            // BUILD CATALOG
            const catalog = document.getElementById("catalog"),
                  character_box = document.getElementById("character-box");
            let misc_items = document.createElement("div"),
                item_div = document.createElement("div"),
                current_rarity = equipment_data.rarity.COMMON;
            item_div.classList.add(current_rarity);
            misc_items.classList.add(equipment_data.rarity.MISC);
            for (const item_name in current_data) {
                let item = document.createElement("i");
                item.classList.add("item-sprite", get_item_sprite_class(item_name));
                item.title = item_name;
                item.onclick = function () {
                    document.getElementById("catalog").hidden = true;
                    document.getElementById("character-box-button").hidden = true;
                    document.getElementById("recipe-data-div").hidden = document.getElementById("back").hidden = false;
                    build_data(item_name);
                    window.scrollTo(0, 0);
                };

                const item_rarity = current_data[item_name]["rarity"];
                if (item_rarity === equipment_data.rarity.MISC) {
                    misc_items.appendChild(item);
                    continue;
                }

                if (item_rarity !== current_rarity) {
                    catalog.appendChild(item_div);
                    item_div = document.createElement("div");
                    current_rarity = item_rarity;
                    item_div.classList.add(current_rarity);
                }

                item_div.appendChild(item);

                // BUILD COMPONENT USAGE DATA
                for (const comp_name of current_data[item_name]["req_items"]) {
                    if (component_usage.hasOwnProperty(comp_name)) {
                        component_usage[comp_name].push(item_name);
                    }
                    else {
                        component_usage[comp_name] = [ item_name ];
                    }
                }
            }

            catalog.appendChild(item_div);
            catalog.appendChild(misc_items);

            // IF LOCALSTORAGE SUPPORT IS AVAILABLE...
            if (typeof(Storage) !== "undefined") {
                // REVEAL CHARACTER BOX BUTTON
                document.getElementById("character-box-button").hidden = false;
                localstorage_data = localStorage.getItem(LOCALSTORAGE_KEY);
                if (localstorage_data !== null) {
                    localstorage_data = JSON.parse(localstorage_data);
                }
                else {
                    localstorage_data = [];
                }
            }

            // BUILD ITEM USAGE / CHARACTER BOX
            const char_data = character_data.data();
            for (const unit_id in char_data) {
                // ADD CHARACTER TO CHARACTER BOX
                const elem = document.createElement("span");
                elem.classList.add("unit-sprite", get_unit_sprite_class(unit_id));
                if (localstorage_data.includes(unit_id)) {
                    elem.classList.add("enabled");
                }
                elem.onclick = (mouseEvent) => {
                    const enabled = mouseEvent.srcElement.classList.toggle("enabled");
                    if (typeof(Storage) !== "undefined") {
                        if (enabled) {
                            localstorage_data.push(unit_id);
                            localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(localstorage_data));
                        }
                        else {
                            if (localstorage_data.includes(unit_id)) {
                                const index = localstorage_data.indexOf(unit_id);
                                if (index > -1) {
                                    localstorage_data.splice(index, 1);
                                }
                            }
                            if (localstorage_data.length === 0) {
                                localStorage.removeItem(LOCALSTORAGE_KEY);
                            }
                            else {
                                localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(localstorage_data));
                            }
                        }
                    }
                }
                character_box.appendChild(elem);

                // BUILD ITEM USAGE
                for (let i = 1, j = character_data.max_rank() ; i <= j ; i++) {
                    const rank_array = char_data[unit_id]["rank_" + i];
                    for (const item_name of rank_array) {
                        const unit_string = unit_id + "." + i;
                        if (item_usage.hasOwnProperty(item_name)) {
                            if (!item_usage[item_name].includes(unit_string))
                                item_usage[item_name].push(unit_string);
                        }
                        else {
                            item_usage[item_name] = [ unit_string ];
                        }
                    }
                }
            }
        }

        function build_data(item_name) {
            const item = document.createElement("div"),
                  data_div = document.getElementById("recipe-data-div");
            let is_exists_in_legacy = legacy_data.hasOwnProperty(item_name);
            data_div.innerHTML = "";

            // ITEM NAME
            let name_div = document.createElement("div"),
                name_en = document.createElement("span"),
                name_jp = document.createElement("span");
            name_div.classList.add("names");
            name_en.innerText = item_name;
            name_en.classList.add("name_en");
            name_jp.innerText = current_data[item_name]["name_jp"];
            name_jp.classList.add("name_jp");
            name_div.appendChild(name_en);
            name_div.appendChild(name_jp);
            item.appendChild(name_div);

            // ITEM IMAGE
            let images = document.createElement("div");
            images.classList.add("images");
            let equip_img = document.createElement("img");
            equip_img.classList.add("equip_img");
            equip_img.title = item_name;
            equip_img.src = get_item_image_path(item_name);
            images.appendChild(equip_img);
            if (current_data[item_name]["has_fragments"]) {
                let frag_img = document.createElement("img");
                frag_img.classList.add("frag_img");
                frag_img.title = item_name + " Fragment";
                frag_img.src = get_item_image_path(item_name + " Fragment");
                images.appendChild(frag_img);
            }
            item.appendChild(images);


            // CURRENT/LEGACY RECIPES
            let current = document.createElement("div");
            current.classList.add("current");
            if (is_exists_in_legacy) {
                let current_span = document.createElement("span");
                current_span.classList.add("title");
                current_span.innerText = "Current Recipe";
                current.appendChild(current_span);
            }
            let current_recipe_div = document.createElement("div");
            current_recipe_div.id = "current_recipe";
            current.appendChild(current_recipe_div);
            current.appendChild(get_recipe_elem(item_name, current_data));
            item.appendChild(current);

            if (is_exists_in_legacy) {
                let legacy = document.createElement("div");
                legacy.classList.add("legacy");
                let legacy_span = document.createElement("span");
                legacy_span.classList.add("title");
                legacy_span.innerText = "Legacy Recipe";
                legacy.appendChild(legacy_span);
                let legacy_recipe_div = document.createElement("div");
                legacy_recipe_div.id = "legacy_recipe";
                legacy.appendChild(legacy_recipe_div);
                legacy.appendChild(get_recipe_elem(item_name, legacy_data));

                if (current.querySelector(".recipe_result").innerHTML === legacy.querySelector(".recipe_result").innerHTML) {
                    // IF BOTH RECIPES ARE THE SAME, NO NEED TO DISPLAY THE LEGACY RECIPE.
                    // DELETE THE "Current Recipe" TITLE TOO
                    is_exists_in_legacy = false;
                    current.removeChild(current.querySelector("span.title"));
                }
                else {
                    item.appendChild(legacy);
                }
            }

            // COMPONENT USAGE
            const comp_usage = component_usage[item_name],
                  comp_usage_elem = document.createElement("div");
            if (typeof comp_usage !== "undefined") {
                comp_usage_elem.classList.add("comp-usage");
                const comp_usage_title = document.createElement("span");
                comp_usage_title.classList.add("title");
                comp_usage_title.innerText = "Equipment Usage";
                comp_usage_elem.appendChild(comp_usage_title);
                for (const parent_item of comp_usage) {
                    const elem = document.createElement("i");
                    elem.classList.add("item-sprite", get_item_sprite_class(parent_item));
                    elem.title = parent_item;
                    elem.onclick = function() {
                        build_data(parent_item);
                    };
                    comp_usage_elem.appendChild(elem);
                }
                item.appendChild(comp_usage_elem);
            }

            // CHARACTER USAGE
            const usage = item_usage[item_name],
                  usage_elem = document.createElement("div");
            if (typeof usage !== "undefined") {
                usage_elem.classList.add("usage");
                const usage_title = document.createElement("span");
                usage_title.classList.add("title");
                usage_title.innerText = "Character Usage";
                usage_elem.appendChild(usage_title);
                let disabled_characters = [];
                for (const usage_string of usage) {
                    const u = usage_string.split('.'),
                        elem = document.createElement("span");
                    elem.classList.add("unit-sprite", get_unit_sprite_class(u[0]), "rank-" + u[1]);
                    elem.innerText = u[1];
                    // IF CHARACTER BOX DATA DOESN'T EXIST...
                    if (localstorage_data.length === 0) {
                        // CREATE AND ADD ELEMENT AS NORMAL
                        usage_elem.appendChild(elem);
                    }
                    else {
                        // CHARACTER BOX DATA EXISTS, ADD UNITS THAT THE USER HAS FIRST
                        if (localstorage_data.includes(u[0])) {
                            usage_elem.appendChild(elem);
                        }
                        else {
                            // USER DOES NOT HAVE THIS UNIT, DISABLE IT AND ADD IT LATER
                            elem.classList.add("disabled");
                            disabled_characters.push(elem);
                        }
                    }
                }

                // ADD DISABLED CHARACTERS IF APPLICABLE
                if (disabled_characters.length > 0) {
                    for (const elem of disabled_characters) {
                        usage_elem.appendChild(elem);
                    }
                }

                item.appendChild(usage_elem);
            }

            data_div.appendChild(item);

            let current_config = build_treant(item_name, current_data, "current_recipe");
            let legacy_config;
            if (is_exists_in_legacy) {
                legacy_config = build_treant(item_name, legacy_data, "legacy_recipe");
                // REBUILD CURRENT RECIPE Treant BECAUSE AFTER LEGACY RECIPE IS ADDED IT WILL BE MISPOSITIONED
                new Treant(current_config);
            }

            const waitForFinal = (function () {
                let timers = {};
                return function (callback, ms, uniqueID) {
                    if (!uniqueID) {
                        uniqueID = "Don't call this twice without an uniqueID";
                    }
                    if (timers[uniqueID]) {
                        clearTimeout(timers[uniqueID]);
                    }
                    timers[uniqueID] = setTimeout(callback, ms);
                }
            })();
            $(window).on("resize", function () {
                waitForFinal(function () {
                    new Treant(current_config);
                    if (is_exists_in_legacy) {
                        new Treant(legacy_config);
                    }
                }, 500, "treant-resize");
            });

            function get_recipe_elem(item_name, data) {
                let recipe_elem = document.createElement("div");
                recipe_elem.classList.add("recipe_result");
                const recipe = get_recipe(item_name, data);
                for (const frag_name in recipe) {
                    let frag = document.createElement("div");
                    frag.title = frag_name;
                    frag.classList.add("item-sprite", get_item_sprite_class(frag_name));
                    let amt = document.createElement("span");
                    amt.innerText = recipe[frag_name];
                    frag.appendChild(amt);
                    recipe_elem.appendChild(frag);
                }
                return recipe_elem;

                function get_recipe(item_name, data) {
                    const item_data = data[item_name];
                    let recipe = {};
                    if (item_data["req_pieces"] > 0) {
                        recipe[item_data["name"] + (item_data["has_fragments"] ? " Fragment" : "")] = item_data["req_pieces"];
                    }

                    // ADD REQUIRED ITEM RECIPES
                    const required_items = item_data["req_items"];
                    for (let i = 0, j = required_items.length ; i < j ; i++) {
                        recipe = merge_recipes(recipe, get_recipe(required_items[i], data));
                    }

                    return recipe;

                    function merge_recipes(...recipes) {
                        return recipes.reduce((a, b) => {
                            for (let f in b) {
                                if (b.hasOwnProperty(f)) {
                                    a[f] = (a[f] || 0) + b[f];
                                }
                            }
                            return a;
                        }, {});
                    }
                }
            }


            function build_treant(item_name, data, element_id) {
                let config = {
                    chart: {
                        container: "#" + element_id,
                        rootOrientation: "NORTH",
                        connectors: {
                            type: "step",
                            style: {
                                "stroke-width": 3
                            }
                        }
                    },
                    nodeStructure: {
                        HTMLclass: "",
                        children: []
                    }
                };
                const item_data = data[item_name];
                let frag_name = item_data["name"] + (item_data["has_fragments"] ? " Fragment" : ""),
                    frag_amount = item_data["req_pieces"];
                config["nodeStructure"]["HTMLclass"] = "item-sprite " + get_item_sprite_class(item_name);
                if (frag_amount > 0) {
                    config["nodeStructure"]["children"] = [
                        {
                            HTMLclass: "item-sprite " + get_item_sprite_class(frag_name),
                            text: {
                                desc: frag_amount
                            }
                        }
                    ];
                }
                else {
                    config["nodeStructure"]["children"] = [];
                }

                // ADD REQUIRED ITEM RECIPES
                const required_items = item_data["req_items"];
                for (let i = 0, j = required_items.length ; i < j ; i++) {
                    config["nodeStructure"]["children"].push(get_req_item(required_items[i]));
                }

                function get_req_item(item_name) {
                    let obj = {},
                        name = data[item_name]["name"] + (data[item_name]["has_fragments"] ? " Fragment" : ""),
                        amount = data[item_name]["req_pieces"];
                    obj["HTMLclass"] = "item-sprite " + get_item_sprite_class(item_name);
                    if (amount > 0) {
                        obj["children"] = [
                            {
                                HTMLclass: "item-sprite " + get_item_sprite_class(name),
                                text: {
                                    desc: amount
                                }
                            }];
                    }
                    else {
                        obj["children"] = [];
                    }

                    let req = data[item_name]["req_items"];
                    for (let i = 0, j = req.length ; i < j ; i++) {
                        obj["children"].push(get_req_item(req[i]));
                    }
                    return obj;
                }
                new Treant(config);
                return config;
            }
        }
    };
</script>

</div><style type="text/css"></style>
</body><style type="text/css"></style><style type="text/css"></style><style type="text/css"></style></html>
